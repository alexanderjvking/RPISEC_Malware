Malware Analysis
Lab 04 - Debugging Concepts and Tools

Lab_04-1.malware

1) Set a breakpoint at 0x00401092, what is this sample calling?
	ModLoad: 77090000 771d2000   ntdll.dll
	ModLoad: 75ab0000 75b85000   C:\Windows\system32\kernel32.dll
	ModLoad: 74e60000 74eab000   C:\Windows\system32\KERNELBASE.dll
 	call    edx {kernel32!GetProcAddress (75afcedc)}
	
2) What is being called at 0x004010A6? What is the callee doing?
	call    eax {kernel32!VirtualAlloc (75afc67a)}
	allocates 0x0B000h at 0C000000h as 

3) What is sub_401360 doing? sub_401372 and sub_401388?
	0x401360 calls KERNEL32!GetProcAddress as well as 0x401372 but 
	with advapi32.dll. 0x401388 uses user32.dll

4) What windows API functions did the sample import?
	GetModuleFileNameA,ExitProcess,CopyFileA,GetWindowsDirectoryA,
	LoadLibraryA,RegCreateKeyA,RegSetKeyValueA,RegCloseKey,MessageBoxA
	
5) How did you find the imported functions?
	Set a breakpoint at each function that called KERNEL32!GetProcAddress
	and looked at the arguments.

6)What does this sample do? 
	Copies itself to C:\\WINDOWS\virus.exe then creates a popup 
	that says infected?

Lab_04-2.malware
1) What is the address of the win/lose function?
	win: 0x004011BC	lose:

2) What does this sample do with the user input?
	for every ascii value you enter it flips the value so if A = 0x41 after
	the flip it would = 0x14

3) What is the address of the encrypted flag?
	data is stored at 0x0040303C the string is stored at 0x00403018

4)Flag?
	flag{Pra1se_th3_Sun!}
	script included.
	
